(self.webpackChunk_brizy_builder=self.webpackChunk_brizy_builder||[]).push([[211],{1114:(e,t,a)=>{e.exports=a(76301)},25879:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduxBatch=function(e){var t=[],a=void 0;function s(){t===a&&(t=t.slice())}function n(e){if("function"!=typeof e)throw new Error("Invalid listener, expected a function");var a=!0;return s(),t.push(e),function(){a&&(s(),t.splice(t.indexOf(e),1),a=!1)}}function r(){for(var e=t,s=0;s<e.length;++s)a=e,e[s]()}return function(){var t=e.apply(void 0,arguments),a=!1,s=!1;function o(e){return Array.isArray(e)?e.map(function(e){return o(e)}):t.dispatch(e)}return t.subscribe(function(){s?a=!0:r()}),Object.assign({},t,{dispatch:function(e){var t=s;t||(a=!1,s=!0);var n=o(e),c=a&&!t;return t||(a=!1,s=!1),c&&r(),n},subscribe:n})}}},53211:(e,t,a)=>{"use strict";a.d(t,{bootstrap:()=>Qe}),a(37227),a(93991);var s=a(69648),n=a(38024);const r="HYDRATE",o="DELETE_GLOBAL_BLOCK";var c=a(11073),i=a(1114);function l(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var d=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),u=()=>Math.random().toString(36).substring(7).split("").join("."),p={INIT:`@@redux/INIT${u()}`,REPLACE:`@@redux/REPLACE${u()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${u()}`};function _(e,t,a){if("function"!=typeof e)throw new Error(l(2));if("function"==typeof t&&"function"==typeof a||"function"==typeof a&&"function"==typeof arguments[3])throw new Error(l(0));if("function"==typeof t&&void 0===a&&(a=t,t=void 0),void 0!==a){if("function"!=typeof a)throw new Error(l(1));return a(_)(e,t)}let s=e,n=t,r=new Map,o=r,c=0,i=!1;function u(){o===r&&(o=new Map,r.forEach((e,t)=>{o.set(t,e)}))}function h(){if(i)throw new Error(l(3));return n}function E(e){if("function"!=typeof e)throw new Error(l(4));if(i)throw new Error(l(5));let t=!0;u();const a=c++;return o.set(a,e),function(){if(t){if(i)throw new Error(l(6));t=!1,u(),o.delete(a),r=null}}}function f(e){if(!function(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}(e))throw new Error(l(7));if(void 0===e.type)throw new Error(l(8));if("string"!=typeof e.type)throw new Error(l(17));if(i)throw new Error(l(9));try{i=!0,n=s(n,e)}finally{i=!1}return(r=o).forEach(e=>{e()}),e}return f({type:p.INIT}),{dispatch:f,subscribe:E,getState:h,replaceReducer:function(e){if("function"!=typeof e)throw new Error(l(10));s=e,f({type:p.REPLACE})},[d]:function(){const e=E;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(l(11));function a(){const e=t;e.next&&e.next(h())}return a(),{unsubscribe:e(a)}},[d](){return this}}}}}function h(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce((e,t)=>(...a)=>e(t(...a)))}a(99930),a(81975);var E=a(56324),f=a(86646),O=a(99399);a(29217);const y="UNDO";class b{snapshots=[];config={maxSize:20,collapseFrequency:2e3};currentIndex=-1;previousIndex=-1;lastSnapshotTimestamp=0;canUndo_=!1;canRedo_=!1;constructor(e){e&&(this.config=e),this.snapshots=new Array(this.config.maxSize).fill(null)}getSnapshots(){return this.snapshots}getCurrentSnapshot(){return this.snapshots[this.currentIndex]??null}getPreviousSnapshot(){return this.snapshots[this.previousIndex]??null}getSnapshot(e){if(e>0){const t=e-1;return this.snapshots[t]??null}{const t=this.snapshots.filter(e=>null!==e).length+e;return this.snapshots[t]??null}}update(e,t){if(Object.keys(e).some(t=>e[t]!==this.snapshots[this.currentIndex]?.[t])){const a=e,s=Date.now();if(t?.replacePresent)this.snapshots[this.currentIndex]=a;else{if(this.snapshots[this.currentIndex+1]&&null!==this.snapshots[this.currentIndex+1]){this.previousIndex=this.currentIndex,this.currentIndex++,this.snapshots[this.currentIndex]=a;for(let e=this.currentIndex+1;e<=this.snapshots.length-1;e++)this.snapshots[e]=null}else if(s-this.lastSnapshotTimestamp>this.config.collapseFrequency)if(this.currentIndex===this.snapshots.length-1){for(let e=0;e<=this.snapshots.length-2;e++)this.snapshots[e]=this.snapshots[e+1];this.snapshots[this.snapshots.length-1]=a}else this.previousIndex=this.currentIndex,this.currentIndex++,this.snapshots[this.currentIndex]=a;else this.snapshots[this.currentIndex]=a;this.updateFlags(),this.lastSnapshotTimestamp=s}}}replaceSnapshots(e){if(e.length!==this.snapshots.length)throw new Error("History. snapshots must be of same lengths");for(let t=0;t<this.snapshots.length;t++)if(null===this.snapshots[t]&&null!==e[t]||null!==this.snapshots[t]&&null===e[t])throw new Error("History. only patch snapshots supported for now");this.snapshots=e}canUndo(){return this.canUndo_}undo(){this.canUndo()&&(this.previousIndex=this.currentIndex,this.currentIndex--,this.updateFlags())}canRedo(){return this.canRedo_}redo(){this.canRedo()&&(this.previousIndex=this.currentIndex,this.currentIndex++,this.updateFlags())}updateFlags(){this.canUndo_=this.currentIndex>0,this.canRedo_=Boolean(this.snapshots[this.currentIndex+1]&&null!==this.snapshots[this.currentIndex+1])}}function m(e,t){return{...e,history:{currSnapshot:t.getCurrentSnapshot(),prevSnapshot:t.getPreviousSnapshot(),canUndo:t.canUndo(),canRedo:t.canRedo()}}}var g=a(38662),T=a(17279),A=a(66181),L=a(25551);a(73242);var P=a(27033);const S={inProcessing:0,inPending:!1,blocks:{},initialized:!1},B={value:{items:[]},path:[]},M="REGENERATED",v="u2354e9A74GE",R=e=>e.find(e=>e.title===M&&e.id===v);var C=a(24902),D=a(83414),k=a(38032);(0,g.ht)(!1);var I=a(53160),j=a(99453);const U=e=>e.type&&e.value&&e.value._id&&e.value._thumbnailSrc;function K(e){const t={};return(0,O.A)(e,e=>{if(U(e)){const a=e.value;t[e.value._id]={_thumbnailSrc:a._thumbnailSrc,_thumbnailWidth:a._thumbnailWidth,_thumbnailHeight:a._thumbnailHeight,_thumbnailTime:a._thumbnailTime}}}),t}const x={deviceMode:"desktop",activeElement:null,leftSidebar:{drawerContentType:null},rightSidebar:{type:"options",isOpen:!1,lock:void 0,alignment:"right",activeTab:void 0,expanded:!1},showHiddenElements:!1,currentRole:"default",currentLanguage:"default"},w=function(e,t){const a=new b;return function(s,n){switch(n.type){case y:case"REDO":{const e=n.type===y?a.canUndo():a.canRedo(),t=n.type===y?a.undo:a.redo;return e?(t.call(a),m({...s,...a.getCurrentSnapshot(),storeWasChanged:f.O.changed},a)):"object"==typeof(r=s).history&&null!==r.history&&(0,O.dl)(["currSnapshot","prevSnapshot","canUndo","canRedo"],r.history)?s:m({...s,...a.getCurrentSnapshot(),storeWasChanged:f.O.changed},a)}default:{const r=e(s,n);if(!n.type.includes("@@redux/INIT")){t.onBeforeUpdate&&t.onBeforeUpdate(s,n,a);const e=function(e,t){return t.reduce((t,a)=>(t[a]=e[a],t),{})}(r,t.keysToTrack);a.update(e,{replacePresent:Boolean(n?.meta?.historyReplacePresent)})}return m(r,a)}}var r}}((G={authorized:(e,t)=>{switch(t.type){case"HYDRATE":{const{authorized:e}=t.payload;return e}case"UPDATE_AUTHORIZATION":return t.payload;default:return e}},syncAllowed:(e,t)=>{switch(t.type){case"HYDRATE":{const{syncAllowed:e}=t.payload;return e}case"UPDATE_SYNC_ALLOWED":return t.payload;default:return e}},blocksData:(e={},t,a)=>{switch(t.type){case"HYDRATE":{const{page:e,globalBlocks:a,editorMode:s}=t.payload,r=e.data?.items||[];if((0,n.mV)(s)&&0===r.length)return{ecupxjcqmrpxjdimoebbkbnotrlufkfokjvr:{type:"Story",value:{_styles:["story"],items:[{type:"StoryItem",value:{_styles:["story-item"],items:[],_id:"dfmwxzkwbiaezltvsxhdinhplvimzenkiqto"}}],_id:"ecupxjcqmrpxjdimoebbkbnotrlufkfokjvr"},blockId:"StoryDefault"}};const o=r.reduce((e,t)=>{const a=(0,g.jM)(t,e=>{delete e.meta}),{_id:s,globalBlockId:n}=a.value;return e[n||s]=a,e},{}),c=Object.entries(a).reduce((e,[t,a])=>(e[t]=(0,g.jM)(a.data,e=>{e.value._id=t}),e),{});return(0,g.jM)({...o,...c},e=>{(0,O.A)(e,e=>{if(e.type&&"GlobalBlock"===e.type){const{globalBlockId:t}=e.value;t&&(e.value._id=t,delete e.value.globalBlockId)}})})}case E.Q3.IMPORT_STORY:{const{blocks:s}=t.payload,{insertIndex:n}=t.meta,r=(0,c.G2)(a)[0],o=(0,L.e8)(e[r].value.items,n,s);return(0,T.Oe)(e,[r,"value","items"],o)}case"ADD_BLOCK":{const{block:a}=t.payload;return{...e,[a.value._id]:a}}case"MAKE_POPUP_TO_GLOBAL_POPUP":{const{block:{data:a},fromBlockId:s}=t.payload,n=(0,L.BR)(e=>e.value._id===s?(0,A.Bv)({blockId:e.blockId,uid:a.value._id}):e,e);return(0,g.jM)(n,e=>{e[a.value._id]=a})}case"MAKE_GLOBAL_POPUP_TO_POPUP":{const{block:a,fromBlockId:s,type:n}=t.payload;if("external"===n)return{...e,[a.value._id]:a};const r=t.payload.parentId,o=e=>e.value._id===s?a:e,c=e=>(0,L.yX)(e)?(0,O.Tj)(c,o(e)):(0,O.Tj)(c,e),i=e=>!!(0,L.yX)(e)&&e.value._id===r,l=e=>i(e)?c(e):(0,O.Tj)(l,e);return l(e)}case"MAKE_GLOBAL_BLOCK_TO_BLOCK":{const{block:a}=t.payload;return{...e,[a.value._id]:a}}case"MAKE_BLOCK_TO_GLOBAL_BLOCK":{const{block:{data:a},fromBlockId:s}=t.payload;return(0,g.jM)(e,e=>{e[a.value._id]=a,delete e[s]})}case o:{const{id:a}=t.payload;return(0,g.jM)(e,e=>{delete e[a]})}case E.Q3.REMOVE_BLOCK:{const{index:s}=t.payload,n=(0,c.bb)(a),r=Object.keys(n),o=(0,c.G2)(a)[s];return r.includes(o)?e:(0,g.jM)(e,e=>{delete e[o]})}case E.Q3.REMOVE_BLOCKS:{const t=(0,c.G2)(a),s=(0,c.bb)(a),n=Object.keys(s),r=t.filter(e=>!n.includes(e));return(0,g.jM)(e,e=>{r.forEach(t=>{delete e[t]})})}case"UPDATE_GLOBAL_BLOCK":{const{uid:a,data:s}=t.payload;return null===s.value?e:{...e,[a]:s}}case E.Q3.IMPORT_TEMPLATE:case"UPDATE_BLOCKS":{const{blocks:a}=t.payload,s=a.reduce((e,t)=>("GlobalBlock"===t.type||(e[t.value._id]=t),e),{});return{...e,...s}}default:return e}},copiedElement:(e=B,t)=>t.type===E.Q3.COPY_ELEMENT?{...e,...t.value}:e,error:(e=null,t)=>{switch(t.type){case"HYDRATE":{const{projectStatus:a}=t.payload;return a&&a.locked?{code:C.tG.PROJECT_LOCKED_ERROR,data:a}:e}case E.Q3.UPDATE_ERROR:return t.payload;default:return e}},extraFontStyles:(e=[],t)=>{switch(t.type){case"HYDRATE":{const{project:e}=t.payload;return e.data.extraFontStyles}case"UPDATE_EXTRA_FONT_STYLES":return t.payload;case E.Q3.IMPORT_TEMPLATE:case"ADD_BLOCK":case"ADD_GLOBAL_BLOCK":case"ADD_GLOBAL_POPUP":{const{extraFontStyles:a}=t.payload;return a&&0!==a.length?[...e,...a]:e}default:return e}},fonts:(e={},t)=>{switch(t.type){case"HYDRATE":{const{fonts:e}=t.payload;return e}case"ADD_FONTS":case"DELETE_FONTS":{const a=t.payload;return a?{...e,...a}:e}case E.Q3.IMPORT_STORY:case E.Q3.IMPORT_TEMPLATE:case E.Q3.IMPORT_KIT:case"ADD_BLOCK":case"ADD_GLOBAL_BLOCK":case"ADD_GLOBAL_POPUP":{const{fonts:a}=t.payload;return a&&0!==a.length?(0,g.jM)(e,e=>{a.forEach(({type:t,fonts:a})=>{e[t]=e[t]||{data:[]},e[t].data.push(...a)})}):e}default:return e}},globalBlocks:(e={},t,a)=>{switch(t.type){case"HYDRATE":{const{globalBlocks:e,page:{data:{items:a=[]}},config:s}=t.payload,n=a.filter(e=>e?.value?.globalBlockId).map(e=>e?.value?.globalBlockId);return Object.entries(e).reduce((e,[a,r])=>{const o=(0,g.jM)(r,e=>{e.data.editorVersion=s.editorVersion});return n.includes(a)&&!(0,A.Bs)(r.data)?e[a]=(0,g.jM)(o,e=>{e.rules=(0,A.Vd)(r,!0,t.payload.page,s).rules,e.data.value._id=a}):e[a]=o,e},{})}case"ADD_BLOCK":return e;case"ADD_GLOBAL_BLOCK":{const{_id:s}=t.payload.block.value;return{...e,[s]:(0,A.Vd)(e[s],!0,a?.page,t.payload.config)}}case"MAKE_POPUP_TO_GLOBAL_POPUP":case"MAKE_BLOCK_TO_GLOBAL_BLOCK":{const{uid:a,data:s,status:n,meta:r,rules:o,dataVersion:c,position:i,dependencies:l}=t.payload.block;return(0,g.jM)(e,e=>({[s.value._id]:{uid:a,dataVersion:c,meta:r,data:s,status:n,rules:o,position:i,dependencies:l},...e}))}case"UPDATE_GLOBAL_BLOCK":{const{uid:s,data:n,config:r}=t.payload;if(null===n.value&&!(0,A.Bs)(e[s].data)){const t=(0,A.Vd)(e[s],!1,a?.page,r);return{...e,[s]:t}}return e}case E.Q3.UPDATE_GLOBAL_BLOCK_METADATA:{const{uid:a,title:s="",tags:n=""}=t.payload;return(0,g.jM)(e,e=>{s.length>0&&(e[a].title=s),e[a].tags=n})}case E.Q3.REMOVE_BLOCK:{const{index:s,config:n}=t.payload,r=(0,c.G2)(a),o=Object.keys(e),i=r[s];if(o.includes(r[s])&&!(0,A.Bs)(e[i].data)){const t=(0,A.Vd)(e[i],!1,a?.page,n);return{...e,[i]:t}}return e}case"MAKE_GLOBAL_BLOCK_TO_BLOCK":{const{fromBlockId:s,config:n}=t.payload,r=(0,A.Vd)(e[s],!1,a?.page,n);return{...e,[s]:r}}case"REORDER_BLOCKS":{const{oldIndex:s,newIndex:n,config:r}=t.payload,o=(0,c.G2)(a),i=Object.keys(e);if(i.includes(o[s])){const t=o[s],l=(0,T.Yr)((0,T.Wq)(o,s),n,t),d=o[s],u=(0,A.X5)(o,s,i),p=(0,A.X5)(l,n,i);if("center"===u&&("top"===p||"bottom"===p)&&!(0,A.CB)({pageBlocksIds:(0,c.C_)(a),globalBlocks:e,page:a?.page,config:r}).includes(d)){const t=(0,A.Vd)(e[d],!0,a?.page,r);return{...e,[d]:t}}}return e}case E.Q3.REMOVE_BLOCKS:{const{config:s}=t.payload,n=(0,c.G2)(a),r=Object.keys(e),o=(0,D.E)(n,r);return(0,g.jM)(e,e=>{o.forEach(t=>{(0,A.Bs)(e[t].data)||(e[t]=(0,A.Vd)(e[t],!1,a?.page,s))})})}case"UPDATE_BLOCKS":{const{blocks:s,config:n}=t.payload,r=(0,c.G2)(a),o=s.map(e=>e.value._id),i=(0,k.i)(r,o);return(0,g.jM)(e,e=>{i.forEach(t=>{e[t]&&!(0,A.Bs)(e[t].data)&&(e[t]=(0,A.Vd)(e[t],!1,a?.page,n))})})}case"UPDATE_GB_RULES":{const{id:a,rules:s}=t.payload;return(0,g.jM)(e,e=>{e[a].rules=s})}case o:{const{id:a}=t.payload;return(0,g.jM)(e,e=>{delete e[a]})}case"PUBLISH":{const e=(0,c.$L)(a),s=(0,c.n1)(a,t.payload.config),n=(0,c.vT)(a).reduce((t,a)=>({...t,[a]:e[a]}),{}),r=(0,c.F8)(a,t.payload.config);return Object.entries(e).reduce((t,[a,o])=>(t[a]=(0,g.jM)(o,t=>{const c="SectionPopup"===o.data.type||"SectionPopup2"===o.data.type;t.dependencies=(0,P.p)(t.data,e).filter(e=>"GlobalBlock"===e.type).map(e=>e.value._id),c||(t.position=r[a]||null),(s[a]||n[a]||c)&&(t.status="publish")}),t),{})}default:return e}},changedGBIds:(e=[],t,a)=>{switch(t.type){case"ADD_GLOBAL_BLOCK":case"ADD_GLOBAL_POPUP":return[...e,t.payload.block.value._id];case"MAKE_POPUP_TO_GLOBAL_POPUP":case"MAKE_BLOCK_TO_GLOBAL_BLOCK":return[...e,t.payload.block.data.value._id];case"MAKE_GLOBAL_POPUP_TO_POPUP":case"MAKE_GLOBAL_BLOCK_TO_BLOCK":{const{fromBlockId:a}=t.payload;return e.includes(a)?e:[...e,a]}case E.Q3.REMOVE_BLOCK:{const{id:s}=t.payload;return(0,c.bb)(a)[s]&&!e.includes(s)?[...e,s]:e}case E.Q3.REMOVE_BLOCKS:{const s=(0,c.n1)(a,t.payload.config),n=Object.keys(s),r=e;for(let t=0;t<n.length;t++){const a=n[t];e.includes(a)||r.push(a)}return r}case"UPDATE_GLOBAL_BLOCK":case E.Q3.UPDATE_GLOBAL_BLOCK_METADATA:{const{uid:a}=t.payload;return e.includes(a)?e:[...e,a]}case"FETCH_PAGE_SUCCESS":return[];default:return e}},page:(e,t,a)=>{switch(t.type){case"HYDRATE":{const{page:e,config:a}=t.payload;return(0,g.jM)(e,e=>{e.data.editorVersion=a.editorVersion})}case"PUBLISH":{const{status:s,editorMode:r}=t.payload;if((0,c.gn)(a)!==f.O.changed&&s===e.status)return e;const o=(0,n.Bs)(r)?(0,c.zY)(a):(0,c.xg)(a),i=[...(0,c.yv)(a).map(e=>e.value._id),...(0,c.No)(a)];return(0,g.jM)(o,e=>{e.status=s,e.dependencies=i,e.dataVersion=e.dataVersion+1})}case"UPDATE_TRIGGERS":{const{data:a}=t.payload;return(0,g.jM)(e,e=>{e.data.triggers=a,e.dataVersion=e.dataVersion+1})}case"UPDATE_POPUP_RULES":return(0,g.jM)(e,e=>{e.data.rulesAmount=t.payload.rules.length,e.dataVersion=e.dataVersion+1});case"UPDATE_PAGE_LAYOUT":{const{layout:a,config:s}=t.payload;return(0,I.I_)(e,s)?(0,g.jM)(e,e=>{e.layout.value=a,e.dataVersion=e.dataVersion+1}):e}case"UPDATE_PAGE_TITLE":{const{title:a,config:s}=t.payload;return(0,I.I_)(e,s)?(0,g.jM)(e,e=>{e.title=a,e.dataVersion=e.dataVersion+1}):e}case"UPDATE_PAGE_IS_HOME_PAGE":{const{isHomePage:a,config:s}=t.payload;return(0,I.I_)(e,s)?(0,g.jM)(e,e=>{e.layout.isHomePage=a,e.dataVersion=e.dataVersion+1}):e}default:return e}},blocksOrder:(e=[],t)=>{switch(t.type){case"HYDRATE":{const e=t.payload.page.data?.items||[],{page:a,globalBlocks:s,config:n}=t.payload;if((0,L.mV)(n)&&0===e.length)return["ecupxjcqmrpxjdimoebbkbnotrlufkfokjvr"];const r=e.map(e=>e.value.globalBlockId||e.value._id);return(0,A.cV)({pageBlocksIds:r,page:a,globalBlocks:s,config:n})}case"ADD_GLOBAL_POPUP":case"ADD_GLOBAL_BLOCK":case"ADD_BLOCK":{const{block:a}=t.payload,{insertIndex:s}=t.meta,{_id:n}=a.value;return e.includes(n)?e:(0,T.Yr)(e,s,a.value._id)}case E.Q3.REMOVE_BLOCK:{const{index:a}=t.payload;return(0,T.Wq)(e,a)}case E.Q3.REMOVE_BLOCKS:return[];case"MAKE_GLOBAL_POPUP_TO_POPUP":{const{block:a,fromBlockId:s,type:n}=t.payload;return"external"==n?(0,T._D)(e,e.findIndex(e=>e===s),a.value._id):e}case"MAKE_POPUP_TO_GLOBAL_POPUP":{const{block:a,fromBlockId:s,type:n}=t.payload;return"external"===n?(0,T._D)(e,e.findIndex(e=>e===s),a.data.value._id):e}case"MAKE_BLOCK_TO_GLOBAL_BLOCK":{const{block:a,fromBlockId:s}=t.payload;return(0,T._D)(e,e.findIndex(e=>e===s),a.data.value._id)}case"MAKE_GLOBAL_BLOCK_TO_BLOCK":{const{block:a,fromBlockId:s}=t.payload;return(0,T._D)(e,e.findIndex(e=>e===s),a.value._id)}case"REORDER_BLOCKS":{const{oldIndex:a,newIndex:s}=t.payload,n=e[a];return(0,T.Yr)((0,T.Wq)(e,a),s,n)}case E.Q3.IMPORT_TEMPLATE:{const{blocks:a}=t.payload,{insertIndex:s}=t.meta,n=a.map(e=>e.value._id);return(0,T.Yr)(e,s,n)}case"UPDATE_BLOCKS":{const{blocks:e}=t.payload;return e.map(e=>e.value._id)}case"UPDATE_GLOBAL_BLOCK":{const{uid:a,data:s}=t.payload;return null===s.value?e.filter(e=>e!==a):e}case o:{const{id:a}=t.payload;return e.filter(e=>e!==a)}default:return e}},project:(e,t,a)=>{switch(t.type){case"HYDRATE":{const{project:e,config:a}=t.payload;return(0,g.jM)(e,e=>{e.data.editorVersion=a.editorVersion})}case"PUBLISH":{const{type:s}=t.payload,n=(0,c.qT)(a);return"externalForce"===s?(0,g.jM)(n,e=>{e.dataVersion=e.dataVersion+1}):(0,j.n)(e,n)?e:(0,g.jM)(n,e=>{e.dataVersion=e.dataVersion+1})}case"UPDATE_DISABLED_ELEMENTS":{const a=t.payload;return(0,g.jM)(e,e=>{e.data.disabledElements=a,e.dataVersion=e.dataVersion+1})}case E.Q3.UPDATE_PINNED_ELEMENTS:{const a=t.payload;return(0,g.jM)(e,e=>{e.data.pinnedElements=a,e.dataVersion=e.dataVersion+1})}case E.Q3.IMPORT_KIT:{const{selectedKit:a}=t.payload;return(0,g.jM)(e,e=>{e.data.selectedKit=a,e.dataVersion=e.dataVersion+1})}case"UPDATE_CURRENT_KIT_ID":{const a=t.payload;return(0,g.jM)(e,e=>{e.data.selectedKit=a,e.dataVersion=e.dataVersion+1})}case E.Q3.IMPORT_STORY:case E.Q3.IMPORT_TEMPLATE:{const{styles:a,fonts:s}=t.payload;return a?.length||s?.length?(0,g.jM)(e,e=>{e.dataVersion=e.dataVersion+1}):e}case"ADD_FONTS":case"DELETE_FONTS":return(0,g.jM)(e,e=>{e.dataVersion=e.dataVersion+1});case"UPDATE_DEFAULT_FONT":{const a=t.payload;return(0,g.jM)(e,e=>{e.data.font=a,e.dataVersion=e.dataVersion+1})}default:return e}},styles:(e=[],t)=>{switch(t.type){case r:{const{project:e}=t.payload;return e.data.styles}case E.Q3.IMPORT_STORY:case E.Q3.IMPORT_TEMPLATE:case E.Q3.IMPORT_KIT:{const{styles:a}=t.payload;return a?e.find(e=>e.id===a[0].id)?e:[...a,...e]:e}case E.Q3.UPDATE_CURRENT_STYLE:return(0,g.jM)(e,e=>{for(let a=0;a<e.length;a++)e[a].id===t.payload.id&&(e[a]=t.payload)});case E.Q3.REGENERATE_TYPOGRAPHY:case E.Q3.REGENERATE_COLORS:return R(e)?e.map(e=>e.title===M&&e.id==v?t.payload:e):[...e,t.payload];default:return e}},currentStyleId:(e="",t,a)=>{switch(t.type){case"HYDRATE":{const{project:e}=t.payload;return e.data.selectedStyle}case E.Q3.UPDATE_CURRENT_STYLE_ID:return t.payload;case E.Q3.ADD_NEW_GLOBAL_STYLE:return t.payload.id;case E.Q3.REMOVE_GLOBAL_STYLE:return a.styles[0].id;case E.Q3.IMPORT_STORY:case E.Q3.IMPORT_TEMPLATE:{const{currentStyleId:a}=t.payload;return a||e}case E.Q3.REGENERATE_COLORS:case E.Q3.REGENERATE_TYPOGRAPHY:{const e=R(a.styles);return e?e.id:t.payload.id}default:return e}},currentStyle:(e,t,a)=>{switch(t.type){case"HYDRATE":{const{project:e}=t.payload,a=[...e.data.styles,...e.data.extraStyles??[]];return a.find(t=>t.id===e.data.selectedStyle)??a[0]}case E.Q3.UPDATE_CURRENT_STYLE:return t.payload;case E.Q3.UPDATE_CURRENT_STYLE_ID:{const e=t.payload,s=[...a.styles,...a.extraStyles??[]];return s.find(({id:t})=>t===e)??s[0]}case E.Q3.ADD_NEW_GLOBAL_STYLE:return t.payload;case E.Q3.REMOVE_GLOBAL_STYLE:return a.styles[0];case E.Q3.IMPORT_STORY:case E.Q3.IMPORT_TEMPLATE:{const{currentStyleId:s,styles:n}=t.payload,r=[...n??[],...a.styles,...a.extraStyles];return(s?r.find(e=>e.id===s):e)??e}case E.Q3.EDIT_GLOBAL_STYLE_NAME:return{...e,title:t.payload};case E.Q3.REGENERATE_TYPOGRAPHY:case E.Q3.REGENERATE_COLORS:return t.payload;default:return e}},ui:function(e=x,t){if("UPDATE_UI"===t.type){const{key:a,value:s}=t,n={...e,[a]:s};return"deviceMode"===a&&"manual"!==n.rightSidebar.lock&&("desktop"!==s?n.rightSidebar={...n.rightSidebar,isOpen:!0,lock:"auto"}:n.rightSidebar.isOpen&&(n.rightSidebar={...n.rightSidebar,isOpen:!1,lock:void 0})),n}return e},storeWasChanged:(e,t)=>{switch(t.type){case"HYDRATE":return f.O.unchanged;case"FETCH_PAGE_SUCCESS":return e===f.O.pending?f.O.unchanged:e;case"ADD_BLOCK":case E.Q3.REMOVE_BLOCK:case E.Q3.REMOVE_BLOCKS:case"REORDER_BLOCKS":case"UPDATE_BLOCKS":case"UPDATE_GLOBAL_BLOCK":case E.Q3.UPDATE_GLOBAL_BLOCK_METADATA:case"MAKE_BLOCK_TO_GLOBAL_BLOCK":case"MAKE_POPUP_TO_GLOBAL_POPUP":case"MAKE_GLOBAL_POPUP_TO_POPUP":case"MAKE_GLOBAL_BLOCK_TO_BLOCK":case"ADD_GLOBAL_BLOCK":case"ADD_GLOBAL_POPUP":case E.Q3.UPDATE_CURRENT_STYLE_ID:case E.Q3.UPDATE_CURRENT_STYLE:case E.Q3.REGENERATE_TYPOGRAPHY:case E.Q3.REGENERATE_COLORS:case"UPDATE_EXTRA_FONT_STYLES":case E.Q3.IMPORT_TEMPLATE:case E.Q3.IMPORT_STORY:case"UNDO":case"REDO":case E.Q3.CREATE_SYMBOL:case E.Q3.UPDATE_SYMBOL:case E.Q3.DELETE_SYMBOL:return f.O.changed;case"PUBLISH":return f.O.pending;case"STORE_WAS_CHANGED":return t.payload;case E.Q3.UPDATE_ERROR:return f.O.unchanged;default:return e}},extraStyles:(e=[],t,a)=>{switch(t.type){case"HYDRATE":{const{project:e}=t.payload;return e.data.extraStyles}case E.Q3.UPDATE_CURRENT_STYLE:{const s=a.currentStyleId;return(0,g.jM)(e,e=>{const a=e.findIndex(e=>e.id===s);-1!==a&&(e[a]=t.payload)})}case E.Q3.ADD_NEW_GLOBAL_STYLE:return[...e,t.payload];case E.Q3.REMOVE_GLOBAL_STYLE:return e.filter(e=>e.id!==t.payload);case E.Q3.EDIT_GLOBAL_STYLE_NAME:{const s=a.currentStyleId;return(0,g.jM)(e,e=>{const a=e.findIndex(e=>e.id===s);-1!==a&&(e[a].title=t.payload)})}default:return e}},blocksHtml:(e=S,t,a)=>{switch(t.type){case"HYDRATE":{const{page:a,globalBlocks:s,config:n}=t.payload,r=Object.values(s).map(e=>e.blocks||[]).flat(),o=(e=>e.reduce((e,t)=>(e[t.id]={html:t.html},e),{}))([...a.blocks||[],...r]),c=a.data?.items||[],i=c.map(e=>e.value.globalBlockId||e.value._id),l=(0,A.cV)({pageBlocksIds:i,page:a,globalBlocks:s,config:n});let d=l.reduce((e,t)=>{const a=o[t];return a&&(e[t]=a),e},{});const u=l.map(e=>s[e]||c.find(t=>t.value._id===e));return(0,P.p)({value:u},s).forEach(e=>{const t=e.value._id,a=o[t];a&&(d={...d,[t]:a})}),(0,g.jM)(e,e=>{e.blocks=d})}case E.Q3.REMOVE_BLOCKS:return S;case"UNDO":case"REDO":case E.Q3.IMPORT_TEMPLATE:case"UPDATE_BLOCKS":case"ADD_BLOCK":case"ADD_GLOBAL_BLOCK":case"ADD_GLOBAL_POPUP":case"UPDATE_GLOBAL_BLOCK":return e.inPending?e:(0,g.jM)(e,e=>{e.inPending=!0});case E.Q3.UPDATE_BLOCK_HTML:{const{blockId:a,data:s}=t.payload;return(0,g.jM)(e,e=>{e.blocks[a]=s})}case E.Q3.UPDATE_BLOCKS_HTML:{const{blocks:a}=t.payload;return(0,g.jM)(e,e=>{a.forEach(({id:t,block:a})=>{e.blocks[t]=a})})}case E.Q3.REMOVE_BLOCK:{const{index:s}=t.payload,n=(0,c.$L)(a),r=Object.keys(n),o=(0,c.G2)(a)[s];return r.includes(o)?e:(0,g.jM)(e,e=>{delete e.blocks[o]})}case E.Q3.UPDATE_BLOCK_HTML_STATS:{const{stats:a}=t.payload;return(0,g.jM)(e,e=>{e.inProcessing=a,e.initialized||(e.initialized=!0),0===a&&(e.inPending=!1),a>0&&!e.inPending&&(e.inPending=!0)})}case E.Q3.INITIALIZE_BLOCKS_HTML:return(0,g.jM)(e,e=>{e.initialized=!0});case"FETCH_PAGE_SUCCESS":return(0,g.jM)(e,e=>{e.blocks=Object.keys(e.blocks).reduce((e,t)=>(e[t]={html:""},e),{})});case o:{const{id:a}=t.payload;return(0,g.jM)(e,e=>{delete e.blocks[a]})}default:return e}},symbols:(e,t)=>{switch(t.type){case r:{const{symbols:e}=t.payload;return{element:void 0,classes:e??[]}}case E.Q3.CREATE_SYMBOL:{const{element:a,cssClasses:s}=t.payload;return(0,g.jM)(e,e=>{e.element=a,e.classes.push(...s)})}case E.Q3.UPDATE_SYMBOL:{const{element:a,cssClass:s}=t.payload;return(0,g.jM)(e,e=>{e.element=a,e.classes=e.classes.map(e=>e.uid===s.uid?s:e)})}case E.Q3.DELETE_SYMBOL:{const a=t.payload.filter(Boolean);return(0,g.jM)(e,e=>{e.classes=e.classes.filter(e=>!a.includes(e.uid))})}default:return e}},symbolsCSS:(e,t)=>{switch(t.type){case E.Q3.UPDDATE_SYMBOLS_CSS:return t.payload;case E.We:return{};default:return e}}},Q={screenshots:(e,t,a,s)=>{switch(t.type){case"HYDRATE":case"PUBLISH":{const e=K(s.page.data),t={};for(const[e,a]of Object.entries(s.globalBlocks)){const s=a.data;if(U(s)){const a=s.value;t[e]={_thumbnailSrc:a._thumbnailSrc,_thumbnailWidth:a._thumbnailWidth,_thumbnailHeight:a._thumbnailHeight,_thumbnailTime:a._thumbnailTime}}Object.assign(t,K(s.value))}return{...e,...t,_published:{...e,...t}}}case E.Q3.UPDATE_SCREENSHOT:{const{payload:{blockId:a,data:s}}=t;return(0,g.jM)(e,e=>{e[a]=s})}case"MAKE_POPUP_TO_GLOBAL_POPUP":case"MAKE_BLOCK_TO_GLOBAL_BLOCK":{const{data:{value:{_id:a}},meta:s}=t.payload.block,n=(e=>{if(void 0!==e._thumbnailSrc&&void 0!==e._thumbnailWidth&&void 0!==e._thumbnailHeight&&void 0!==e._thumbnailTime)return{_thumbnailSrc:e._thumbnailSrc,_thumbnailWidth:e._thumbnailWidth,_thumbnailHeight:e._thumbnailHeight,_thumbnailTime:e._thumbnailTime}})(s);return n?(0,g.jM)(e,e=>{e[a]=n,e._published[a]=n}):e}default:return e}}},(e={},t)=>{const a={};return Object.entries(G).reduce((a,[s,n])=>(a[s]=n(e[s],t,e),a),a),Object.entries(Q).reduce((a,[s,n])=>(a[s]=n(e[s],t,e,a),a),a),a}),{keysToTrack:["blocksOrder","blocksData","currentStyleId","currentStyle","extraFontStyles","storeWasChanged","extraStyles","symbols"],onBeforeUpdate:(e,t,a)=>{if("UPDATE_GB_RULES"===t.type||t.type===E.Q3.REMOVE_BLOCK||t.type===E.Q3.REMOVE_BLOCKS){const s=(0,c.G2)(e),n=(0,c.bb)(e);(t.type===E.Q3.REMOVE_BLOCKS?s:[t.payload.id]).forEach(e=>{if(s.includes(e)&&n[e]){const t=a.getSnapshots();a.replaceSnapshots(t.map(t=>(t?.blocksOrder&&(t.blocksOrder=t.blocksOrder.filter(t=>t!==e)),t)))}})}}});var G,Q;var V=a(75180),N=a(11410),Y=a(63696),H=a(26339),F=a(53816),z=a(41712);class W{instance;constructor(e){this.instance=Object.freeze(new z.cj(e))}getStyles(){return this.instance.getStyles()}purge(){this.instance.purge()}}var $=a(71468),q=a(65253),X=a(30236),Z=a(54145),J=a(66362),ee=a(62925),te=a(6230),ae=a(91024),se=a(72130),ne=a(16765),re=a(67377);class oe extends te.A{static get componentId(){return ae.U.ThirdPartyItems}static defaultProps={meta:{},itemProps:{},sliceStartIndex:0,sliceEndIndex:1/0};getItemProps(e,t){const a={getItems:()=>[{id:"duplicate",type:"button",devices:"desktop",config:{icon:"nc-duplicate",title:(0,ne.t)("Duplicate"),reverseTheme:!0},position:200,onClick:()=>{this.cloneItem(t)}},{id:"remove",type:"button",devices:"desktop",config:{icon:"nc-trash",title:(0,ne.t)("Delete"),reverseTheme:!0},position:250,onClick:()=>{(0,ee.Ar)(),this.removeItem(t)}}]},s=this.makeToolbarPropsFromConfig2(a);return{meta:this.props.meta,toolbarExtend:s}}handleSortableAcceptElements=(e,t)=>{const{elementType:a,elementNode:s}=e,{acceptedElements:n=["column","shortcode","addable"]}=this.props;if(Array.isArray(n)){const e=-1!==n.indexOf(a),t=s.getAttribute((0,re.uo)("sortable-subtype")),r=-1!==n.indexOf(t);return e||r}return e.sortableNode===t.sortableNode};renderItemsContainer(e){const{className:t}=this.props;return(0,se.eg)(this.props.renderContext)?Y.createElement("div",{className:t},e):0===e.length?Y.createElement("div",{className:t},Y.createElement(J.A,{path:this.getId(),type:"thirdPartyContainer",acceptElements:this.handleSortableAcceptElements})):Y.createElement(Z.A,{path:this.getId(),type:"thirdPartyContainer",acceptElements:this.handleSortableAcceptElements},(a,s)=>Y.createElement("div",{...s,ref:a,className:t},e))}}const ce=oe;function ie(e){const{editorProps:t}=(()=>{const e=(0,Y.useContext)(X.l);if(!e)throw new Error("useThirdParty must be used within a ThirdPartyProvider");return e})(),{acceptedElements:a,className:s}=e;return Y.createElement(ce,{...t,acceptedElements:a,className:s})}var le=a(7366);class de extends Y.Component{constructor(e){super(e),this.register(e.config),(0,le.U)("getEditorElements",this.getEditorElements)}getEditorElements=()=>({Container:ie});register(e){const t=(0,q.Ay)(e);for(const e of Object.values(t))H.A.registerComponent(e);H.A.registerNotFoundComponent(q.X1);const a=e.thirdPartyComponents;a&&Object.values(a).forEach(e=>{H.A.registerThirdPartyElement(e)})}render(){return this.props.children}}var ue=a(16486),pe=a(55247);const _e=e=>{const{children:t,pageId:a,groups:s}=e,{sheet:n}=(0,pe.Y)(),r=(0,Y.useMemo)(()=>({sheet:n,dynamicContent:{itemId:a,config:s}}),[a,s,n]);return Y.createElement(ue.k.Provider,{value:r},t)};var he=a(47310),Ee=a(26356),fe=a(48917);function Oe(e){const{sheet:t,store:a,config:s,children:r,editorMode:o}=e,c=fe.F.init({resources:{}}),i=s.pageData?.id??"";return Y.createElement(Ee.I,{sheet:t},Y.createElement(he.x,{i18n:c},Y.createElement($.Kq,{store:a},Y.createElement(F.s,{config:s},Y.createElement(de,{config:s},Y.createElement(se.Ku,{renderType:"view"},Y.createElement(n.CZ,{mode:o},Y.createElement(pe.N,null,Y.createElement(_e,{pageId:i},r)))))))))}var ye=a(78444),be=a(2852),me=a(44295),ge=(a(71336),a(89858),a(8620),a(9604)),Te=a(13686),Ae=a(76999),Le=a(97493),Pe=a(82414);var Se=a(83293);const Be=e=>{e((0,re.pk)({name:"mmenu-id"})).each(function(){const t=(0,Se.uR)(),a=e(this),s=a.children(".brz-menu__mmenu");a.attr((0,re.uo)("mmenu-id"),`#${t}`),s&&s.attr("id",t)})};var Me=a(94009);const ve=/data-brz-(.+)-/,Re=["data-brz-onclick-event","data-brz-onsubmit-event"],Ce=e=>{const t=Re.map(e=>`[${e}]`).join(",");e(t).each(function(){const t=e(this),a=Object.entries(t.attr()).filter(e=>{const[t]=e;return(0,Me.bt)(t)});for(let e=0;e<a.length;e++){const[s,n]=a[e],r=ve.exec(s);if(r)try{const[e,a]=r;t.attr(a,n),t.removeAttr(s)}catch(e){}}})};var De=a(36871);const ke=e=>{const{store:t,sheet:a,config:s,Page:n}=e,r=t.getState(),o=(0,c.gI)(r);(0,me.wH)();const i=be.renderToStaticMarkup(n),l=a.getCSSOrdered(),d=(e=>e.map(e=>({name:"symbol",score:Le.$f,content:{type:"inline",content:e.cssText},attr:{class:e.className}})))(l.symbol),u=ye.Ay.load(`<html>\n      <head></head>\n      <body>${i}</body>\n    </html>`,{decodeEntities:!1});Be(u),Ce(u);const p=(e=>{const{fonts:t,parsedFonts:a,defaultFont:s,projectDefaultFontId:n}=e,{upload:r=[],google:o=[],system:c=[],adobe:i=[]}=(0,De.EH)(t);let l=!1;const{fonts:d}={fonts:{google:[],upload:[],adobe:[],system:[]}},u=t?.adobe?.id;if(a.forEach(({type:e,family:t})=>{switch(l||(l=n===t),e){case"adobe":{const e=(0,De.oh)(i,t);e&&u&&d.adobe.push(e);break}case"system":{const e=(0,De.oh)(c,t);e&&d.system.push(e);break}case"upload":{const e=(0,De.oh)(r,t,"upload");e&&d.upload.push(e);break}case"google":{const e=(0,De.oh)(o,t);e&&d.google.push(e);break}}}),!l){const{group:e,font:t}=s;switch(e){case"upload":d.upload.push(t);break;case"system":d.system.push(t);break;case"adobe":d.adobe.push(t);break;default:d.google.push(t)}}return{fonts:d,adobeKitId:u}})({projectDefaultFontId:o,parsedFonts:(0,me.YW)(),fonts:(0,c.K2)(r),defaultFont:(0,c._K)(r)}),{fonts:_,adobeKitId:h}=p,{freeScripts:E,freeStyles:f,proScripts:O,proStyles:y}=(e=>{const{free:t,pro:a}=(0,Pe.n)(e),{free:s,pro:n}=((e,t)=>{const{t:a=[],A:s=[]}=ge,n=new Set,r=[],{editorVersion:o,pro:c}=t,i={name:"main",score:Le.tk,content:{type:"file",url:(0,Te.R)("editor/js/preview.min.js",t),attr:{class:"brz-script brz-script-preview",defer:"true"}},pro:!1};a.forEach(a=>{const{name:s,selectors:o}=a;r.push({name:s,selectors:o,score:Le.GA,content:{type:"file",url:(0,Te.R)(`editor/js/${s}.min.js`,t),attr:{class:"brz-script brz-script-preview-lib",defer:"true",...(0,re.Mx)({name:"group",value:s})}},pro:!1}),o.forEach(t=>{e(t).length&&n.add(t)})}),0===n.size&&n.add(".brz__group__jquery");const l={free:{main:i,version:o,generic:[],libsMap:r,libsSelectors:[...n]}};if(c){const t=[],a=new Set,n=[],r={name:"main",score:Le.tk,content:{type:"file",url:(0,Ae.U)(c,"js/preview.pro.min.js"),attr:{class:"brz-script brz-script-preview-pro",defer:"true"}},pro:!0};s.forEach(t=>{const{name:s,selectors:r}=t;n.push({name:s,selectors:r,score:Le.GA+1,content:{type:"file",url:(0,Ae.U)(c,`js/${s}.pro.min.js`),attr:{class:"brz-script brz-script-preview-lib-pro",defer:"true",...(0,re.Mx)({name:"group",value:s})}},pro:!0}),r.forEach(t=>{e(t).length&&a.add(t)})}),l.pro={main:r,version:c.version??"",generic:t,libsMap:n,libsSelectors:[...a]}}return l})(e.$root,e.config);return{freeStyles:t,freeScripts:s,...a&&{proStyles:a},...n&&{proScripts:n}}})({$root:u,fonts:_,css:l,config:s,extra:{adobeKitId:h}}),b=(e=>e.replace(/data-brz-dcatts=(["'])(.*?)\1/g,"$2"))(u("body").html()??"");return a.purge(),(0,me.wH)(),{html:b,assets:{freeScripts:E,freeStyles:f,proScripts:O,proStyles:y},symbols:d}},Ie=e=>{const{block:t,store:a,editorMode:s}=e,{Page:n}=H.A.getComponents(),r=(0,F.U)(),o=(0,Y.useCallback)(()=>r,[r]);if(!n)throw Error("Missing Page Components",H.A.getComponents());const c=a.getState(),i={items:[t]};return Y.createElement(Y.Fragment,null,Y.createElement(n,{dbValue:i,reduxStore:a,reduxState:c,renderContext:"view",editorMode:s,getGlobalConfig:o}))},je=e=>{const{block:t,store:a,config:s,editorMode:n}=e,r=new W,o=Y.createElement(Oe,{store:a,sheet:r.instance,config:s,editorMode:n},Y.createElement(Ie,{block:t,store:a,editorMode:n}));return ke({Page:o,sheet:r.instance,store:a,config:s})};var Ue=a(30936);const Ke=e=>{const{block:t,store:a,editorMode:s,className:n}=e,{PagePopup:r}=H.A.getComponents(),o=(0,F.U)(),c=(0,Y.useCallback)(()=>o,[o]);if(!r)throw Error("Missing PagePopup Components",H.A.getComponents());const i=a.getState(),l={items:[t]};return Y.createElement(Y.Fragment,null,Y.createElement(r,{className:n,dbValue:l,reduxStore:a,reduxState:i,renderContext:"view",editorMode:s,getGlobalConfig:c}))},xe=e=>{const{block:t,store:a,config:s,editorMode:n}=e,r=(0,L.QY)(s),o=(0,L.kV)(s)?(0,Ue.l)(s):void 0,c=new W,i=Y.createElement(Oe,{store:a,sheet:c.instance,config:s,editorMode:n},Y.createElement(Ke,{block:t,className:o,store:a,editorMode:n})),l=ke({store:a,Page:i,sheet:c.instance,config:s});if(r)return l;const d=(0,N.n)(s,a),u=["assets","freeStyles","pageStyles"],p=(0,T.O6)(l,u)??[],_=["assets","freeStyles","pageFonts"],h=(0,T.O6)(l,_)??[],E=(0,T.KV)(p,d.styles),f=(0,T.KV)(h,d.fonts),O=(0,T.Oe)(l,u,E);return(0,T.Oe)(O,_,f)},we=e=>{const{block:t,store:a,editorMode:s}=e,{PageStory:n}=H.A.getComponents(),r=(0,F.U)(),o=(0,Y.useCallback)(()=>r,[r]);if(!n)throw Error("Missing PageStory Components",H.A.getComponents());const c=a.getState(),i={items:[t]};return Y.createElement(Y.Fragment,null,Y.createElement(n,{dbValue:i,reduxStore:a,reduxState:c,renderContext:"view",editorMode:s,getGlobalConfig:o}))},Ge=e=>{const{block:t,store:a,config:s,editorMode:n}=e,r=new W,o=Y.createElement(Oe,{store:a,sheet:r.instance,config:s,editorMode:n},Y.createElement(we,{block:t,store:a,editorMode:n}));return ke({store:a,Page:o,sheet:r.instance,config:s})};async function Qe(e){const{config:t,page:a,project:o,editorMode:d}=e,{globalBlocks:u=[],symbols:p}=t,{fonts:E}=o.data,f=function({middleware:e=[]}={middleware:[]}){return _(w,h(i.reduxBatch,function(...e){return t=>(a,s)=>{const n=t(a,s);let r=()=>{throw new Error(l(15))};const o={getState:n.getState,dispatch:(e,...t)=>r(e,...t)},c=e.map(e=>e(o));return r=h(...c)(n.dispatch),{...n,dispatch:r}}}(...e)))}(),O=u?.reduce((e,t)=>(e[t.uid]=t,e),{})??{},y=(0,s.A)(E,{system:{data:V.VY}});f.dispatch(function({project:e,projectStatus:t,fonts:a,page:s,globalBlocks:n,authorized:o,syncAllowed:c,config:i,editorMode:l,symbols:d}){return{type:r,payload:{project:e,projectStatus:t,fonts:a,page:s,globalBlocks:n,authorized:o,syncAllowed:c,config:i,editorMode:l,symbols:d}}}({page:a,project:o,fonts:y,globalBlocks:O,config:t,projectStatus:{},editorMode:d,symbols:p}));const b=(0,c.zT)(f.getState(),t),m={store:f,config:t,editorMode:d},g=(0,N.n)(t,f);return(0,n.Bs)(d)?{project:g,blocks:b.map(e=>({id:e.value._id,block:xe({...m,block:e})}))}:(0,n.mV)(d)?{project:g,blocks:b.map(e=>({id:e.value._id,block:Ge({...m,block:e})}))}:{project:g,blocks:b.map(e=>({id:e.value._id,block:je({...m,block:e})}))}}},76301:(e,t,a)=>{"use strict";var s=a(25879);Object.defineProperty(t,"reduxBatch",{enumerable:!0,get:function(){return s.reduxBatch}})}}]);